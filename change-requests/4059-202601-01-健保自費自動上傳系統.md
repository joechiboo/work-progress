製表日期： 115 年 01 月 23 日                  紀錄編號：4059-202601-01
部門名稱：資訊部                              填表人員：紀伯喬

變更項目：健保自費自動上傳系統（Clinic NHI AutoUpload）

預定執行期程：自 115 年 01 月 13 日 至 115 年 01 月 23 日止

---

## 變更需求

變更原因及內容說明：

診所端健保申報作業中，自費項目上傳流程仍需人工操作，效率低且易出錯。需開發自動化上傳工具以提升作業效率。

**變更原因：**
1. 診所端自費項目上傳為人工作業，每日需耗費大量時間
2. 人工操作易有遺漏或重複上傳問題
3. 多站點部署需求，各站點設定不同

**變更內容：**
1. 開發 .NET 9 Console Application（NHI.AutoUpload）
2. 整合 MSSQL 資料庫，自動讀取待上傳之自費資料
3. 實作批次選取功能（依醫令號批次勾選）
4. 效能優化：
   - 修正 N+1 查詢問題，改為批次載入
   - 優化 batch save 邏輯
   - 修正 UpdateLoginRecord 效能問題
5. 站點配置管理：
   - 各站點獨立設定檔（station-specific config）
   - Publish 腳本自動化部署
6. 撰寫專案文件供 demo 展示

**影響範圍：** 新增 HealthInsurance\Clinic_NHI_Update 獨立應用程式

申請人員：紀伯喬

---

## 變更評估

**影響分析：**
- 影響模組：新增獨立 Console 應用程式
- 資料庫：MSSQL，讀取健保申報資料表（唯讀查詢 + 狀態更新）
- 系統環境：需於各診所站點部署 .NET 9 Runtime
- 無需停機，為獨立工具程式
- 備份作業：部署前備份各站點設定檔
- 變更失敗處理：移除部署檔案，恢復人工作業流程

評估人員：紀伯喬

---

## 變更處理

已依原規劃方式完成變更作業：
1. .NET 9 Console App 開發完成（30+ commits）
2. MSSQL 整合與批次查詢效能優化完成
3. 批次選取功能測試通過
4. 各站點設定檔配置完成
5. Publish 自動化腳本運作正常
6. Demo 展示文件已準備

執行人員：紀伯喬

---

## 結果確認

已確認依照原規劃方式執行變更，健保自費自動上傳功能正常運作，各站點部署成功。

確認人員：

安全測試結果：
☒ 無須進行測試
